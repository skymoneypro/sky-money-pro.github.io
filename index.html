<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sky Money Pro | Premium Edition</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&family=Poppins:wght@500;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary: #0f172a; --secondary: #2563eb; --accent: #38bdf8;
            --light: #f8fafc; --white: #ffffff; --success: #10b981; --danger: #f43f5e;
            --card-bg: #ffffff; --input-bg: #f1f5f9; --border-color: #e2e8f0;
            --card-shadow: 0 10px 25px -5px rgba(0,0,0,0.05);
            --text-muted: #64748b; --nav-bg: #ffffff;
        }

        body.dark-mode {
            --primary: #f8fafc; --secondary: #60a5fa; --light: #0f172a; 
            --white: #1e293b; --card-bg: #1e293b; --input-bg: #334155; 
            --border-color: #334155; --text-muted: #94a3b8; --nav-bg: #1e293b;
            --card-shadow: 0 10px 15px -3px rgba(0,0,0,0.5);
            color: var(--primary);
        }

        body { margin: 0; background: var(--light); color: var(--primary); font-family: 'Inter', sans-serif; overflow-x: hidden; transition: 0.3s; }

        /* Toast & General UI */
        #toast-container { position: fixed; top: 20px; right: 20px; z-index: 99999; }
        .toast-card { min-width: 250px; background: var(--card-bg); padding: 15px; border-radius: 15px; margin-bottom: 10px; box-shadow: var(--card-shadow); border-left: 5px solid var(--secondary); display: flex; align-items: center; transform: translateX(120%); transition: 0.4s; }
        .toast-card.show { transform: translateX(0); }

        /* Hero Sections */
        .home-hero, .profile-hero {
            background: linear-gradient(135deg, #2563eb 0%, #0f172a 100%);
            padding: 60px 25px 130px; border-radius: 0 0 45px 45px;
            color: white; text-align: center; position: relative;
        }

        /* Wallet Card */
        .premium-card {
            background: rgba(255, 255, 255, 0.15); backdrop-filter: blur(15px);
            border: 1px solid rgba(255, 255, 255, 0.2); margin: -100px 20px 25px;
            padding: 30px 20px; border-radius: 30px; text-align: center;
            box-shadow: 0 20px 40px rgba(0,0,0,0.2); color: white;
        }

        /* Deposit UI Improvements */
        .amount-selector { display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px; margin-bottom: 20px; }
        .amt-pill { 
            background: var(--card-bg); border: 1px solid var(--border-color);
            padding: 15px; border-radius: 18px; font-weight: 700; cursor: pointer;
            transition: 0.2s; text-align: center; color: var(--primary);
        }
        .amt-pill:active { transform: scale(0.95); background: var(--secondary); color: white; }

        .method-box {
            background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%);
            border: 2px dashed #f59e0b; padding: 25px; border-radius: 25px; margin: 20px 0;
            color: #92400e;
        }

        /* Profile Specific */
        .profile-stat-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; padding: 0 20px; margin-top: -30px; }
        .stat-box { 
            background: var(--card-bg); padding: 20px; border-radius: 22px; 
            box-shadow: var(--card-shadow); border: 1px solid var(--border-color);
        }
        .user-avatar { width: 90px; height: 90px; background: white; border-radius: 30px; margin: 0 auto 15px; display: flex; align-items: center; justify-content: center; font-size: 40px; color: var(--secondary); box-shadow: 0 10px 20px rgba(0,0,0,0.1); }

        /* Modern Navigation Bar */
        .nav-bar {
            position: fixed; bottom: 15px; left: 15px; right: 15px;
            height: 75px; background: var(--nav-bg); 
            display: flex; justify-content: space-around; align-items: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.1); border-radius: 25px; z-index: 1000;
            border: 1px solid var(--border-color);
        }
        .nav-item { color: var(--text-muted); text-align: center; transition: 0.3s; flex: 1; position: relative; }
        .nav-item i { font-size: 22px; margin-bottom: 4px; display: block; }
        .nav-item span { font-size: 10px; font-weight: 600; text-transform: uppercase; letter-spacing: 0.5px; }
        .nav-item.active { color: var(--secondary); }
        .nav-item.active::after {
            content: ''; position: absolute; top: -12px; left: 50%; transform: translateX(-50%);
            width: 20px; height: 4px; background: var(--secondary); border-radius: 10px;
        }

        /* Inputs & Buttons */
        .btn-action { 
            background: var(--secondary); color: white; border: none; padding: 18px; 
            border-radius: 20px; font-weight: 700; width: 100%; cursor: pointer;
            box-shadow: 0 10px 20px -5px rgba(37, 99, 235, 0.4);
        }
        input { 
            width: 100%; padding: 16px; margin: 10px 0; border-radius: 18px; 
            border: 1px solid var(--border-color); background: var(--input-bg); 
            color: var(--primary); box-sizing: border-box; font-size: 15px;
        }

        .page { display: none; padding-bottom: 120px; animation: slideUp 0.4s ease; }
        .page.active { display: block; }
        @keyframes slideUp { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body>

<div id="toast-container"></div>

<div id="auth-screen">
    <div style="text-align:center; padding: 20px; min-height: 100vh; background: #0f172a; display: flex; align-items: center; justify-content: center;">
        <div style="background: white; padding: 40px; border-radius: 40px; width: 100%; max-width: 380px;">
            <h2 style="color:#0f172a; font-family:'Poppins'; margin-bottom:30px;">Sky Money <span style="color:var(--secondary);">Pro</span></h2>
            <div id="login-form">
                <input type="email" id="l-email" placeholder="Email Address">
                <input type="password" id="l-pass" placeholder="Password">
                <button class="btn-action" onclick="login()">SIGN IN</button>
                <p onclick="toggleAuth(true)" style="font-size:13px; margin-top:20px; color:var(--text-muted);">New member? <span style="color:var(--secondary); font-weight:bold;">Create Account</span></p>
            </div>
            <div id="reg-form" style="display:none;">
                <input type="email" id="r-email" placeholder="Email Address">
                <input type="password" id="r-pass" placeholder="Password">
                <button class="btn-action" onclick="register()">REGISTER NOW</button>
                <p onclick="toggleAuth(false)" style="font-size:13px; margin-top:20px; color:var(--text-muted);">Already have an account? <span style="color:var(--secondary); font-weight:bold;">Login</span></p>
            </div>
        </div>
    </div>
</div>

<div id="main-app" style="display:none;">
    <section id="home" class="page active">
        <div class="home-hero">
            <button style="position: absolute; right: 25px; top: 20px; border:none; background:rgba(255,255,255,0.1); color:white; width:45px; height:45px; border-radius:15px;" onclick="toggleTheme()"><i class="fas fa-moon" id="theme-icon"></i></button>
            <h2 style="margin:0; font-family:'Poppins';">Dashboard</h2>
            <p style="font-size:12px; opacity:0.7;">Welcome back to Sky Money Pro</p>
        </div>
        <div class="premium-card">
            <div style="font-size: 12px; opacity: 0.8; letter-spacing: 1px;">AVAILABLE BALANCE</div>
            <div style="font-size: 40px; font-weight: 700; margin: 10px 0;">Rs. <span id="bal-text">0</span></div>
            <button onclick="getDailyBonus()" id="bonus-btn" style="background:var(--white); color:var(--secondary); border:none; padding:12px 25px; border-radius:15px; font-weight:700; font-size:12px;">CLAIM DAILY BONUS</button>
        </div>
        <div style="padding: 0 25px;"><h3 style="font-size:18px;">Active Mining</h3><div id="mining-status-area"></div></div>
    </section>

    <section id="deposit" class="page">
        <div style="padding:25px;">
            <h2 style="font-family:'Poppins';">Deposit Funds</h2>
            <p style="color:var(--text-muted); font-size:14px; margin-bottom:25px;">Select an amount and complete transaction.</p>
            
            <div class="amount-selector">
                <div class="amt-pill" onclick="setAmt('d', 1000)">Rs. 1000</div>
                <div class="amt-pill" onclick="setAmt('d', 2000)">Rs. 2000</div>
                <div class="amt-pill" onclick="setAmt('d', 5000)">Rs. 5000</div>
                <div class="amt-pill" onclick="setAmt('d', 10000)">Rs. 10000</div>
            </div>

            <div class="method-box">
                <div style="display:flex; justify-content:space-between; align-items:center;">
                    <span><i class="fas fa-university"></i> Binance Pay ID</span>
                    <button onclick="copyID()" style="border:none; background:var(--secondary); color:white; padding:5px 12px; border-radius:8px; font-size:12px;">COPY</button>
                </div>
                <div style="font-size:24px; font-weight:800; margin-top:10px;">12345678</div>
            </div>

            <input type="number" id="d-amt" placeholder="Enter Amount (Rs.)">
            <input type="text" id="d-txid" placeholder="Transaction ID (TXID)">
            <button class="btn-action" style="margin-top:10px;" onclick="submitReq('deposit')">SUBMIT DEPOSIT</button>
        </div>
    </section>

    <section id="withdraw" class="page">
        <div style="padding:25px;">
            <h2 style="font-family:'Poppins';">Withdraw</h2>
            <input type="number" id="w-amt" placeholder="Withdrawal Amount">
            <input type="text" id="w-details" placeholder="Binance ID / Wallet Address">
            <button class="btn-action" onclick="submitReq('withdraw')">CONFIRM WITHDRAWAL</button>
        </div>
    </section>

    <section id="market" class="page">
        <h2 style="padding:25px 25px 0;">Mining Plans</h2>
        <div style="padding: 20px;" id="market-list"></div>
    </section>

    <section id="profile" class="page">
        <div class="profile-hero">
            <div class="user-avatar"><i class="fas fa-user-tie"></i></div>
            <h3 id="u-email" style="margin:5px 0;">User Account</h3>
            <span style="background:rgba(255,255,255,0.2); padding:5px 15px; border-radius:20px; font-size:11px;">PREMIUM MEMBER</span>
        </div>
        
        <div class="profile-stat-grid">
            <div class="stat-box">
                <span style="font-size:11px; color:var(--text-muted); font-weight:600;">BALANCE</span>
                <div style="font-size:18px; font-weight:700;">Rs. <span id="p-bal">0</span></div>
            </div>
            <div class="stat-box">
                <span style="font-size:11px; color:var(--text-muted); font-weight:600;">REFERRAL</span>
                <div style="font-size:18px; font-weight:700;" id="u-ref-code">---</div>
            </div>
        </div>

        <h3 style="padding:30px 25px 10px;">Transactions</h3>
        <div id="trans-history" style="padding: 0 5px;"></div>
        
        <div style="padding:25px;"><button class="btn-action" style="background:var(--danger);" onclick="logout()">SIGN OUT</button></div>
    </section>

    <nav class="nav-bar">
        <div class="nav-item active" onclick="nav('home', this)"><i class="fas fa-th-large"></i><span>Home</span></div>
        <div class="nav-item" onclick="nav('market', this)"><i class="fas fa-bolt"></i><span>Plans</span></div>
        <div class="nav-item" onclick="nav('deposit', this)"><i class="fas fa-wallet"></i><span>Deposit</span></div>
        <div class="nav-item" onclick="nav('withdraw', this)"><i class="fas fa-paper-plane"></i><span>Send</span></div>
        <div class="nav-item" onclick="nav('profile', this)"><i class="fas fa-user"></i><span>Profile</span></div>
    </nav>
</div>

<script type="module">
    // Firebase Logic (Same as your original code, kept intact for functionality)
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
    import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, signOut } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
    import { getFirestore, doc, setDoc, updateDoc, arrayUnion, onSnapshot } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

    const firebaseConfig = { apiKey: "AIzaSyA-LrdE3qEML4bk4KXnyFtoy4OQ4Of2IC4", authDomain: "sky-money-47ca1.firebaseapp.com", projectId: "sky-money-47ca1", storageBucket: "sky-money-47ca1.firebasestorage.app", messagingSenderId: "44600459064", appId: "1:44600459064:web:01cb33d3db2b009ce7cbcd" };
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);
    let userData = null;

    window.showToast = (msg, type = 'info') => {
        const container = document.getElementById('toast-container');
        const toast = document.createElement('div');
        toast.className = `toast-card ${type}`;
        toast.innerHTML = `<div style="font-size:13px; font-weight:600;">${msg}</div>`;
        container.appendChild(toast);
        setTimeout(() => toast.classList.add('show'), 100);
        setTimeout(() => { toast.classList.remove('show'); setTimeout(() => toast.remove(), 500); }, 3000);
    };

    window.setAmt = (type, val) => { document.getElementById(type + '-amt').value = val; };
    window.copyID = () => { navigator.clipboard.writeText("12345678"); showToast("ID Copied to clipboard!", "success"); };

    onAuthStateChanged(auth, (user) => {
        if(user) {
            onSnapshot(doc(db, "users", user.uid), (snap) => {
                if(snap.exists()) {
                    userData = snap.data();
                    document.getElementById('auth-screen').style.display = 'none';
                    document.getElementById('main-app').style.display = 'block';
                    updateUI();
                }
            });
        }
    });

    window.updateUI = () => {
        document.getElementById('bal-text').innerText = userData.bal.toLocaleString();
        document.getElementById('p-bal').innerText = userData.bal.toLocaleString();
        document.getElementById('u-email').innerText = userData.email;
        document.getElementById('u-ref-code').innerText = userData.refCode;

        // Mining Status UI
        document.getElementById('mining-status-area').innerHTML = userData.activePlans.map(p => {
            const progress = 45; // Placeholder
            return `<div style="background:var(--card-bg); padding:15px; border-radius:20px; margin-bottom:10px; border:1px solid var(--border-color);">
                <div style="display:flex; justify-content:space-between; font-weight:700;"><span>${p.name}</span><span>${progress}%</span></div>
                <div style="background:var(--input-bg); height:8px; border-radius:10px; margin-top:10px; overflow:hidden;">
                    <div style="background:var(--secondary); width:${progress}%; height:100%;"></div>
                </div>
            </div>`;
        }).join('') || '<p style="color:var(--text-muted);">No mining plans active.</p>';

        // Market Plans UI
        const plans = [
            { name: 'Bronze Cloud', cost: 1000, daily: 50, color: '#f59e0b' },
            { name: 'Silver Cloud', cost: 5000, daily: 300, color: '#2563eb' }
        ];
        document.getElementById('market-list').innerHTML = plans.map(p => `
            <div style="background:var(--card-bg); padding:20px; border-radius:25px; margin-bottom:15px; box-shadow:var(--card-shadow); display:flex; justify-content:space-between; align-items:center;">
                <div><b style="font-size:18px;">${p.name}</b><br><span style="color:var(--success); font-weight:700;">Daily: Rs. ${p.daily}</span></div>
                <button onclick="buyPlan(${p.cost}, ${p.daily}, '${p.name}')" class="btn-action" style="width:auto; padding:10px 20px; background:${p.color};">Invest</button>
            </div>
        `).join('');

        // History UI
        document.getElementById('trans-history').innerHTML = userData.requests.map(r => `
            <div style="background:var(--card-bg); margin:10px 20px; padding:15px; border-radius:15px; display:flex; justify-content:space-between; align-items:center; border:1px solid var(--border-color);">
                <div><b>${r.type.toUpperCase()}</b><br><small>${r.status}</small></div>
                <div style="color:${r.type==='deposit'?'var(--success)':'var(--danger)'}; font-weight:700;">Rs. ${r.amount}</div>
            </div>
        `).reverse().join('');
    };

    window.login = async () => { 
        try { await signInWithEmailAndPassword(auth, document.getElementById('l-email').value, document.getElementById('l-pass').value); } 
        catch(e) { showToast("Authentication Failed!", "error"); } 
    };

    window.register = async () => {
        const e = document.getElementById('r-email').value; const p = document.getElementById('r-pass').value;
        try { const res = await createUserWithEmailAndPassword(auth, e, p); await setDoc(doc(db, "users", res.user.uid), { email: e, bal: 0, refCode: "SKY"+Math.floor(1000+Math.random()*9000), activePlans: [], requests: [], bonusClaimed: false }); } 
        catch(err) { showToast(err.message, "error"); }
    };

    window.logout = () => signOut(auth).then(() => location.reload());
    
    window.submitReq = async (type) => {
        const amt = parseInt(document.getElementById(type === 'deposit' ? 'd-amt' : 'w-amt').value);
        const details = document.getElementById(type === 'deposit' ? 'd-txid' : 'w-details').value;
        if(!amt || !details) return showToast("Please fill all fields!", "error");
        await updateDoc(doc(db, "users", auth.currentUser.uid), { 
            requests: arrayUnion({ type, amount: amt, status: 'pending', payID: details, time: Date.now() }),
            bal: type==='withdraw' ? userData.bal - amt : userData.bal 
        }); 
        showToast("Request submitted successfully!", "success");
    };

    window.nav = (id, el) => { 
        document.querySelectorAll('.page').forEach(p => p.classList.remove('active')); 
        document.getElementById(id).classList.add('active'); 
        document.querySelectorAll('.nav-item').forEach(n => n.classList.remove('active')); 
        el.classList.add('active'); 
    };

    window.toggleTheme = () => { 
        document.body.classList.toggle('dark-mode'); 
        document.getElementById('theme-icon').className = document.body.classList.contains('dark-mode') ? 'fas fa-sun' : 'fas fa-moon'; 
    };
    window.toggleAuth = (isReg) => { document.getElementById('login-form').style.display = isReg ? 'none' : 'block'; document.getElementById('reg-form').style.display = isReg ? 'block' : 'none'; };
</script>

</body>
</html>
